{% load static %}

<div class="product w-full">
	<div class="flex flex-col gap-4 mt-5 w-full">
		{% for product in product_order %}
		<div class="rounded-lg border border-gray-200 p-4 {% if product.product.status %}status-active{% endif %}">

			<!-- En-tête : descriptif + actions -->
			<div class="flex justify-between items-start mb-3">
				<div>
					<span class="font-semibold text-base">{{ product.product.label }}</span>
					{% if product.product.size %}
						<span class="ml-2 text-sm text-gray-500">{{ product.product.size }}</span>
					{% endif %}
				</div>
				<div class="flex items-center gap-3">
					<span class="font-semibold text-base">{{ product.product.selling_price_unit }} €</span>
					<a hx-get="{% url 'webapp:product-edit' pk=product.product.id %}" hx-target="#dialog" class="cursor-pointer hover:opacity-75">
						<img height="10" src="{% static '/img/edit.svg' %}">
					</a>
					<a hx-get="{% url 'webapp:product-delete' pk=product.product.id %}" hx-target="#dialog" class="cursor-pointer hover:opacity-75">
						<img height="10" src="{% static '/img/delete.svg' %}">
					</a>
				</div>
			</div>

			<!-- Détails -->
			<div class="grid grid-cols-2 gap-x-6 gap-y-1 text-sm">
				{% if product.product.artwork_width and product.product.artwork_height %}
				<div><span class="text-gray-500">Oeuvre:</span> {{ product.product.artwork_width }} × {{ product.product.artwork_height }}</div>
				{% endif %}
				{% if product.product.margin or product.product.margin_height %}
				<div><span class="text-gray-500">Marge:</span> {{ product.product.margin|default_if_none:"—" }} × {{ product.product.margin_height|default_if_none:"—" }}</div>
				{% endif %}
				{% if product.product.frame %}
				<div><span class="text-gray-500">Cadre:</span> {{ product.product.frame }}</div>
				{% endif %}
				{% if product.product.wand %}
				<div><span class="text-gray-500">Baguette:</span> {{ product.product.wand }}</div>
				{% endif %}
				{% if product.product.glass and product.product.glass != "Sans" %}
				<div><span class="text-gray-500">Verre:</span> {{ product.product.glass }}</div>
				{% endif %}
				{% if product.product.mat %}
				<div><span class="text-gray-500">Passe-partout:</span> {{ product.product.mat }}</div>
				{% endif %}
				{% if product.product.mesh %}
				<div><span class="text-gray-500">Filet:</span> {{ product.product.mesh }}</div>
				{% endif %}
			</div>

		</div>
		{% endfor %}
	</div>
</div>
<!-- Afficher le total de la commande -->
{% if total_order > 100 %}
<div colspan="5" class="text-right mr-10 mb-5 text-sm">
	Acompte proposé de <b>{{ deposit }} €</b> (30% du total)
</div>
{% endif %}

<div class="flex justify-end mb-5 mr-5">
    <table>
        <tr>
            <td class="text-left align-top" style="padding-right: 20px; padding-top: 10px;"> 
                Total de la commande :
            </td>
            <td class="text-right align-top" style="padding-top: 10px;">
                <b>{{ total_order|floatformat:2 }}</b> €
            </td>
        </tr>
        <tr>
            <td class="text-left align-top" style="padding-right: 20px; padding-top: 10px;"> 
                Acompte perçu :
            </td>
            <td class="text-right align-top" style="padding-top: 10px;">
                <b>{{ order.deposit }}</b> €
            </td>
        </tr>
		<tr>
            <td class="text-left align-top" style="padding-right: 20px; padding-top: 10px;"> 
                Reste à percevoir :
            </td>
            <td class="text-right align-top" style="padding-top: 10px;">
                <b>{{ remaining }}</b> €
            </td>
        </tr>
    </table>
</div>





